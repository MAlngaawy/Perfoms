import{a as D,r as l,R as z,e as Y,f as V,j as e,F as M,d as u,g as P,h as $,i as W,k as se,l as J,m as N,n as q,o as K,p as oe,M as X,q as ne,t as k,D as le,v as I,w as Z,x as ie,V as ee,y as de,z as ce,B as ue,C as te,E as me,I as pe,P as Q,_ as U,J as be,G as ae,K as he,L as fe,O as ge,Q as xe,W as we,X as ve,Y as Se,Z as ye}from"./index.815bf49c.js";const Ne=({setFormInputsData:f,formInputsData:t,setSelectedTeam:n,selectedTeam:g,handleChange:a,errors:o})=>{const{data:b}=D(null),[v,S]=l.exports.useState([]),[y,r]=z.useState([]),[d,h]=l.exports.useState(0),{data:i}=Y({club_id:b==null?void 0:b.club},{skip:!(b!=null&&b.club)}),{data:c}=V({sport_id:d},{skip:!d});return l.exports.useEffect(()=>{r([]),f({...t,team:""}),n(null),i&&i.results&&S(i.results),c&&c.results.length>0?r(c.results):(r([]),f({...t,team:""}),n(null))},[i,c,d]),e(M,{children:u("div",{className:"flex gap-4 w-full my-4",children:[e("div",{className:"w-1/2",children:e(P,{error:o.sport,id:"sport",required:!0,className:"w-full",label:"Sport",name:"sport",sx:{".mantine-Select-input":{background:"none",border:0,borderBottom:"1px solid",borderRadius:0,width:"100%"}},data:v==null?void 0:v.map(m=>({value:m.id,label:m.name})),onChange:m=>{m&&h(+m),m&&a("sport",+m)}})}),e("div",{className:"w-1/2",children:e(P,{id:"team",error:o.team,required:!0,className:"w-full",label:"Team",name:"team",value:g,onChange:m=>{m&&(n(m),a("team",+m))},sx:{".mantine-Select-input":{background:"none",border:0,borderBottom:"1px solid",borderRadius:0,width:"100%"}},data:y==null?void 0:y.map(m=>({label:m.name,value:m.id}))})})]})})},Ce=l.exports.forwardRef(({image:f,label:t,id:n,...g},a)=>e("div",{ref:a,...g,children:u($,{noWrap:!0,children:[e(W,{radius:"xl",size:"sm",src:f}),e("div",{children:e(se,{size:"sm",children:t})})]})})),_e=J().shape({parent:N().required("You  have to select a parent").typeError("It Must Be Number"),name:N().max(100,"Name Can't be more than 100 character").required("Player Name is required"),dob:N(),sport:q().required("You Must select a sport").typeError("You Have to select a sport"),team:q().required("You  Must select a team").typeError("You Have to select a team"),weight:N(),height:N(),front_leg:N(),phoneNumber:N().length(11,"phone number must be 11 characters long").optional().matches(/^\d+$/,"phone number must only contain numbers")}),H={name:"",dob:"",sport:"",team:"",weight:"",height:"",front_leg:"",phoneNumber:""},ke=f=>{const{data:t}=D(null),{refetch:n}=K({club_id:t==null?void 0:t.club},{skip:!(t!=null&&t.club)}),[g,a]=l.exports.useState(!1),[o,b]=l.exports.useState(H),[v,S]=l.exports.useState(null),[y,r]=l.exports.useState([{label:"",value:"",image:""}]),[d,h]=l.exports.useState(!1),[i,c]=l.exports.useState({}),[m,R]=l.exports.useState(null),{data:_}=oe({club_id:t==null?void 0:t.club},{skip:!(t!=null&&t.club)});l.exports.useEffect(()=>{if(_){const p=_==null?void 0:_.results.map(w=>({label:w.first_name+" "+w.last_name,value:JSON.stringify(w.id),image:w.avatar}));r(p)}},[_]);const C=(p,w)=>{b({...o,[p]:w})};return e("div",{children:u(M,{children:[e(X,{opened:g,onClose:()=>{a(!1)},title:"Create Player",children:u("form",{onSubmit:async p=>{p.preventDefault(),c({});const w=new FormData(p.currentTarget);try{if(await _e.validate(o,{abortEarly:!1}),console.log("Await Passed",o),v){const x=await I.resizeImage(v);w.append("icon",x)}try{h(!0),ie.post("club-manager/add-player/",w).then(x=>{h(!1),a(!1),S(null),n(),b(H)}).catch(x=>{h(!1),console.log(x.response.statusText)})}catch(x){console.log(x)}}catch(x){console.log(x);const T={};x instanceof ee&&(x.inner.forEach(L=>{T[L.path]=L.message}),c(T))}},className:"rounded-3xl",children:[e(ne,{inputAlt:"Player Photo",userAvatar:v,setUserAvatar:S}),u("div",{className:"flex flex-col my-4 justify-center items-center gap-2",children:[e("div",{className:"w-full",children:e(P,{id:"parent",name:"parent",data:y,error:i.parent,itemComponent:Ce,label:"Parent",onChange:p=>C("parent",p),sx:{".mantine-Select-input":{background:"none",border:0,borderBottom:"1px solid",borderRadius:0,width:"100%"}},rightSection:!1,className:"m-0 p-0 h-fit border-0"})}),u("div",{className:"flex gap-4 w-full",children:[e("div",{className:"w-1/2",children:e(k,{id:"name",name:"name",label:"Name",withAsterisk:!0,error:i.name,onChange:p=>C("name",p.target.value),sx:{".mantine-TextInput-input":{background:"none",border:0,borderBottom:"1px solid",borderRadius:0,width:"100%"}}})}),e("div",{className:"w-1/2",children:e(le,{label:"Date of birth",name:"dob",maxDate:new Date,inputFormat:"YYYY-MM-DD",error:i.dob,onChange:p=>C("dob",I.formatDate(p)),sx:{".mantine-DatePicker-input":{background:"none",border:0,borderBottom:"1px solid",borderRadius:0}}})})]})]}),e(Ne,{errors:i,formInputsData:o,handleChange:C,selectedTeam:m,setFormInputsData:b,setSelectedTeam:R}),u("div",{className:"flex gap-4 my-4",children:[e("div",{className:"w-1/2",children:e(k,{id:"weight",label:"Weight",error:i.weight,name:"weight",onChange:p=>C("weight",p.target.value),sx:{".mantine-TextInput-input":{background:"none",border:0,borderBottom:"1px solid",borderRadius:0}}})}),e("div",{className:"w-1/2",children:e(k,{id:"height",label:"Height",name:"height",error:i.height,onChange:p=>C("height",p.target.value),sx:{".mantine-TextInput-input":{background:"none",border:0,borderBottom:"1px solid",borderRadius:0}}})})]}),e(P,{id:"front_leg",error:i.front_leg,className:"w-full",label:"Preferred Front Leg",name:"front_leg",sx:{".mantine-Select-input":{background:"none",border:0,borderBottom:"1px solid",borderRadius:0,width:"100%"}},data:[{value:"LEFT",label:"Left"},{value:"RIGHT",label:"Right"},{value:"BOTH",label:"Both"}]}),e("div",{className:"w-full my-4",children:e(k,{id:"phoneNumber",label:"phone number",name:"phone",error:i.phoneNumber,onChange:p=>C("phoneNumber",p.target.value),sx:{".mantine-TextInput-input":{background:"none",border:0,borderBottom:"1px solid",borderRadius:0}}})}),e(Z,{isLoading:d,text:"Add Player"})]})}),e($,{position:"left",children:e("button",{className:"py-1 px-4 transform hover:scale-105 transition-all text-xs border border-perfGray3 text-perfGray3 rounded-3xl",onClick:()=>a(!0),children:"+ Create Player"})})]})})},Ae=J().shape({mobile:N().required("Phone number is required").length(11,"phone number must be 11 characters long").matches(/^\d+$/,"phone number must only contain numbers"),first_name:N().required("First name is required"),last_name:N().required("Last name is required"),sport:q().required("You Must select a sport").typeError("You Have to select a sport"),teams:de().of(q()).min(1,"At least on team is required"),password:N().required("Password is required").min(8,"Password must be at least 8 characters long"),confirmPassword:N().required("Please confirm your password").oneOf([ce("password"),null],"Passwords must match")}),O={first_name:"",last_name:"",sport:"",teams:[],password:"",confirmPassword:"",mobile:""},Pe=f=>{const[t,{open:n,close:g}]=ue(!1),{data:a}=D(null),[o,b]=l.exports.useState(O),[v,S]=l.exports.useState(!1),[y,r]=l.exports.useState(null),[d,h]=l.exports.useState({}),{refetch:i}=te({club_id:a==null?void 0:a.club},{skip:!(a!=null&&a.club)}),c=(s,G)=>{b({...o,[s]:G})},[m,R]=l.exports.useState([]),[_,C]=z.useState([]),[B,p]=l.exports.useState(0),{data:w}=Y({club_id:a==null?void 0:a.club},{skip:!(a!=null&&a.club)}),{data:x}=V({sport_id:B},{skip:!B});l.exports.useEffect(()=>{w&&w.results&&R(w.results),x&&x.results.length>0?C(x.results):(C([]),b({...o,teams:[]}),r(null))},[w,x,B]);const[T]=me();return u(M,{children:[e(X,{opened:t,onClose:g,title:"Add Attendance Moderator",children:u("form",{onSubmit:async s=>{s.preventDefault();const G=new FormData(s.currentTarget);for(const[A,F]of G.entries())console.log(`${A}: ${F}`);const re={mobile:"+2"+o.mobile,first_name:o.first_name,last_name:o.last_name,password:o.password,teams:o.teams};try{S(!0),await Ae.validate(o,{abortEarly:!1}),T(re).then(()=>{S(!1),g(),i(),b(O),I.showNotificationFun("Success","Done","Attendance Modeartor Added Successfully")}).catch(A=>{S(!1),console.log(),I.showNotificationFun("Error","Sorry",A.response.statusText)})}catch(A){S(!1);const F={};A instanceof ee&&(A.inner.forEach(j=>{F[j.path]=j.message}),h(F))}},className:"rounded-xl py-4 flex flex-col gap-4 justify-between",children:[e(k,{id:"mobile",name:"mobile",label:"Mobile",withAsterisk:!0,error:d.mobile,onChange:s=>c("mobile",s.target.value),sx:{".mantine-TextInput-input":{background:"none",border:0,borderBottom:"1px solid",borderRadius:0,width:"100%"}}}),u("div",{className:"flex gap-2",children:[e(k,{id:"first_name",name:"first_name",label:"First Name",withAsterisk:!0,error:d.first_name,onChange:s=>c("first_name",s.target.value),sx:{".mantine-TextInput-input":{background:"none",border:0,borderBottom:"1px solid",borderRadius:0,width:"100%"}}}),e(k,{autoComplete:"off",id:"last_name",name:"last_name",label:"Last Name",withAsterisk:!0,error:d.last_name,onChange:s=>c("last_name",s.target.value),sx:{".mantine-TextInput-input":{background:"none",border:0,borderBottom:"1px solid",borderRadius:0,width:"100%"}}})]}),u("div",{className:"flex flex-col gap-4 w-full my-4",children:[e(P,{error:d.sport,id:"sport",required:!0,className:"w-full",label:"Sport",name:"sport",sx:{".mantine-Select-input":{background:"none",border:0,borderBottom:"1px solid",borderRadius:0,width:"100%"}},data:m==null?void 0:m.map(s=>({value:s.id,label:s.name})),onChange:s=>{s&&p(+s),s&&c("sport",+s)}}),e(pe,{id:"teams",error:d.teams,required:!0,className:"w-full",label:"Teams",name:"teams",value:y,onChange:s=>{console.log(s),s&&(r(s),c("teams",s))},sx:{".mantine-MultiSelect-input":{background:"none",border:0,borderBottom:"1px solid",borderRadius:0,width:"100%"}},data:_==null?void 0:_.map(s=>({label:s.name,value:s.id}))})]}),e(Q,{autoComplete:"new-password",id:"password",name:"password",label:"Password",error:d.password,withAsterisk:!0,onChange:s=>c("password",s.target.value),sx:{".mantine-PasswordInput-input":{border:0},".mantine-PasswordInput-innerInput":{background:"none",border:0,borderBottom:"1px solid",borderRadius:0,width:"100%"}}}),e(Q,{autoComplete:"new-password",id:"confirmPassword",name:"confirm Password",label:"Confirm Password",error:d.confirmPassword,withAsterisk:!0,onChange:s=>c("confirmPassword",s.target.value),sx:{".mantine-PasswordInput-input":{border:0},".mantine-PasswordInput-innerInput":{background:"none",border:0,borderBottom:"1px solid",borderRadius:0,width:"100%"}}}),e(Z,{isLoading:v,text:"Create Att Moderator"})]})}),e($,{position:"left",children:u(M,{children:[e("button",{className:"py-1 xs:hidden px-4 transform hover:scale-105 transition-all text-xs sm:text-base border border-perfGray3 text-perfGray3 rounded-3xl",onClick:n,children:"+"}),e("button",{className:"py-1 px-4 hidden xs:block transform hover:scale-105 transition-all text-xs border border-perfGray3 text-perfGray3 rounded-3xl",onClick:n,children:"+ Add Attendance Moderator"})]})})]})},E=({type:f,data:t})=>{const[n,g]=l.exports.useState(""),[a,o]=l.exports.useState(t),[b,v]=l.exports.useState(),[S,y]=l.exports.useState(["All"]),{data:r}=D({}),{data:d}=Y({club_id:r==null?void 0:r.club});return l.exports.useEffect(()=>{if(d){let h=["All"];for(let i of d.results)h.push(i.name);y(h)}},[d]),l.exports.useEffect(()=>{if(n.length>0){let h;f==="Player"?h=U.filter(t,i=>{var c;return(c=i.name)==null?void 0:c.toLowerCase().includes(n.toLocaleLowerCase())}):h=U.filter(t,i=>{let c=i.first_name+i.last_name;return c==null?void 0:c.toLowerCase().includes(n.toLocaleLowerCase())}),o(h)}else o(t)},[n,t]),u("div",{className:"bg-white rounded-lg p-4 pt-0 ",children:[u("div",{className:"header flex flex-col sm:flex-row justify-between items-start py-4",children:[u("h2",{className:"text-sm sm:text-lg text-perfGray1 mb-2 sm:mb-0",children:[f==="Coach"?"Coaches":f+"s"," in the system"]}),u("div",{className:"flex gap-6 justify-center items-center",children:[f==="Player"&&e(ke,{}),f==="Attendance Moderator"&&e(Pe,{}),e(P,{placeholder:"Filter By Sport",value:b,onChange:h=>v(h),data:S}),e(k,{onChange:h=>g(h.target.value),value:n,icon:e(be,{className:"w-5 h-5",icon:"MagnifyingGlassIcon:outline"}),placeholder:"Search"})]})]}),e("div",{className:"h-60 overflow-y-scroll",children:e(ae,{className:"w-full",gutter:"sm",children:a&&a.length>0?e(Ie,{newData:a,selectedSport:b,type:f}):e("div",{className:"flex w-full items-center justify-center pt-10",children:u("h1",{className:"bg-pagesBg p-6",children:["No ",f," In this Club"]})})})})]})},Ie=({newData:f,selectedSport:t,type:n})=>{const g=he(),[a]=fe(),[o]=ge(),[b]=xe(),[v]=we(),S=r=>{let d;switch(n.toLowerCase()){case"player":d=a({player_id:r});break;case"coach":d=o({coach_id:r});break;case"supervisor":d=b({supervisor_id:r});break;case"attendance moderator":d=v({subCoach_id:r});break;default:throw new Error("Invalid user type")}d.then(i=>{I.showNotificationFun("Success","Done","Successfully Deleted")}).catch(i=>{I.showNotificationFun("Error","Wrong","err.message")})},y=f.filter(r=>!t||t==="All"?!0:r.sport===t);return y.length===0?e("div",{className:"flex w-full items-center justify-center pt-10",children:u("h1",{className:"bg-pagesBg p-6",children:[t," Sport doesn't have any ",n]})}):y.map(r=>e(ae.Col,{className:"w-fit h-fit",span:12,xs:6,sm:4,children:u("div",{className:"flex justify-between rounded-3xl mr-10 items-center p-1  hover:bg-pagesBg transition-all",children:[u("div",{onClick:()=>n==="Player"&&g(`/players/${r.id}`),style:{cursor:n==="Player"?"pointer":"auto"},className:"coach-data flex gap-2 items-center",children:[e(W,{src:r.avatar||r.icon,size:"sm",radius:"xl"}),e("h3",{className:"text-base text-perfGray2",children:r.first_name&&r.first_name+" "+r.last_name||r.name})]}),e(ve,{deleteFun:()=>S(JSON.stringify(r.id)),type:n,name:r.first_name||r.name})]})},r.id))},Be=f=>{const{data:t}=D({}),{data:n}=K({club_id:t==null?void 0:t.club},{skip:!(t!=null&&t.club)}),{data:g}=Se({club_id:t==null?void 0:t.club},{skip:!(t!=null&&t.club)}),{data:a}=ye({club_id:t==null?void 0:t.club},{skip:!(t!=null&&t.club)}),{data:o}=te({club_id:t==null?void 0:t.club},{skip:!(t!=null&&t.club)});return u("div",{className:"flex flex-col gap-6  pt-6 mb-10",children:[e(E,{type:"Coach",data:g==null?void 0:g.results}),o&&e(E,{type:"Attendance Moderator",data:o==null?void 0:o.results}),e(E,{type:"Supervisor",data:a==null?void 0:a.results}),e(E,{type:"Player",data:n==null?void 0:n.results})]})};export{Be as default};
