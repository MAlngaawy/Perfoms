import{a as M,r as l,R as W,e as Y,f as z,j as e,F as E,d as m,g as D,h as $,i as V,k as se,l as J,m as C,n as G,o as K,p as oe,M as X,q as ne,t as k,D as le,v as F,w as Z,x as ie,V as ee,y as de,z as ce,B as ue,C as te,E as me,I as pe,P as Q,_ as H,J as he,G as ae,K as be,L as fe,O as ge,Q as xe,W as we,X as ve,Y as ye,Z as Se}from"./index.a78fe25a.js";const Ne=({setFormInputsData:f,formInputsData:t,setSelectedTeam:i,selectedTeam:n,handleChange:s,errors:d,setSelectedSportName:w})=>{const{data:g}=M(null),[x,S]=l.exports.useState([]),[r,c]=W.useState([]),[h,v]=l.exports.useState(0),{data:u}=Y({club_id:g==null?void 0:g.club},{skip:!(g!=null&&g.club)}),{data:p}=z({sport_id:h},{skip:!h});return l.exports.useEffect(()=>{c([]),f({...t,team:""}),i(null),u&&u.results&&S(u.results),p&&p.results.length>0?c(p.results):(c([]),f({...t,team:""}),i(null))},[u,p,h]),e(E,{children:m("div",{className:"flex gap-4 w-full my-4",children:[e("div",{className:"w-1/2",children:e(D,{error:d.sport,id:"sport",required:!0,className:"w-full",label:"Sport",name:"sport",sx:{".mantine-Select-input":{background:"none",border:0,borderBottom:"1px solid",borderRadius:0,width:"100%"}},data:x==null?void 0:x.map(b=>({value:b.id,label:b.name})),onChange:b=>{if(b){v(+b),s("sport",+b);let P=x.filter(I=>I.id===b);w(P[0].name)}}})}),e("div",{className:"w-1/2",children:e(D,{id:"team",error:d.team,required:!0,className:"w-full",label:"Team",name:"team",value:n,onChange:b=>{b&&(i(b),s("team",+b))},sx:{".mantine-Select-input":{background:"none",border:0,borderBottom:"1px solid",borderRadius:0,width:"100%"}},data:r==null?void 0:r.map(b=>({label:b.name,value:b.id}))})})]})})},Ce=l.exports.forwardRef(({image:f,label:t,id:i,...n},s)=>e("div",{ref:s,...n,children:m($,{noWrap:!0,children:[e(V,{radius:"xl",size:"sm",src:f}),e("div",{children:e(se,{size:"sm",children:t})})]})})),_e=J().shape({parent:C().required("You  have to select a parent").typeError("It Must Be Number"),name:C().max(100,"Name Can't be more than 100 character").required("Player Name is required"),dob:C(),sport:G().required("You Must select a sport").typeError("You Have to select a sport"),team:G().required("You  Must select a team").typeError("You Have to select a team"),weight:C(),height:C(),front_leg:C(),phoneNumber:C().length(11,"phone number must be 11 characters long").optional().matches(/^\d+$/,"phone number must only contain numbers")}),O={name:"",dob:"",sport:"",team:"",weight:"",height:"",front_leg:"",phoneNumber:""},ke=f=>{const[t,i]=l.exports.useState(""),{data:n}=M(null),{refetch:s}=K({club_id:n==null?void 0:n.club},{skip:!(n!=null&&n.club)}),[d,w]=l.exports.useState(!1),[g,x]=l.exports.useState(O),[S,r]=l.exports.useState(null),[c,h]=l.exports.useState([{label:"",value:"",image:""}]),[v,u]=l.exports.useState(!1),[p,b]=l.exports.useState({}),[P,I]=l.exports.useState(null),{data:A}=oe({club_id:n==null?void 0:n.club},{skip:!(n!=null&&n.club)});l.exports.useEffect(()=>{if(A){const o=A==null?void 0:A.results.map(y=>({label:y.first_name+" "+y.last_name,value:JSON.stringify(y.id),image:y.avatar}));h(o)}},[A]);const N=(o,y)=>{x({...g,[o]:y})};return e("div",{children:m(E,{children:[e(X,{opened:d,onClose:()=>{w(!1)},title:"Create Player",children:m("form",{onSubmit:async o=>{o.preventDefault(),b({});const y=new FormData(o.currentTarget);try{if(await _e.validate(g,{abortEarly:!1}),console.log("Await Passed",g),S){const _=await F.resizeImage(S);y.append("icon",_)}y.set("phone","+2"+y.get("phone"));try{u(!0),ie.post("club-manager/add-player/",y).then(_=>{u(!1),w(!1),r(null),s(),x(O)}).catch(_=>{u(!1),console.log(_.response.statusText)})}catch(_){console.log(_)}}catch(_){console.log(_);const a={};_ instanceof ee&&(_.inner.forEach(B=>{a[B.path]=B.message}),b(a))}},className:"rounded-3xl",children:[e(ne,{inputAlt:"Player Photo",userAvatar:S,setUserAvatar:r}),m("div",{className:"flex flex-col my-4 justify-center items-center gap-2",children:[e("div",{className:"w-full",children:e(D,{id:"parent",name:"parent",data:c,error:p.parent,itemComponent:Ce,label:"Parent",onChange:o=>N("parent",o),sx:{".mantine-Select-input":{background:"none",border:0,borderBottom:"1px solid",borderRadius:0,width:"100%"}},rightSection:!1,className:"m-0 p-0 h-fit border-0"})}),m("div",{className:"flex gap-4 w-full",children:[e("div",{className:"w-1/2",children:e(k,{id:"name",name:"name",label:"Name",withAsterisk:!0,error:p.name,onChange:o=>N("name",o.target.value),sx:{".mantine-TextInput-input":{background:"none",border:0,borderBottom:"1px solid",borderRadius:0,width:"100%"}}})}),e("div",{className:"w-1/2",children:e(le,{label:"Date of birth",name:"dob",maxDate:new Date,inputFormat:"YYYY-MM-DD",error:p.dob,onChange:o=>N("dob",F.formatDate(o)),sx:{".mantine-DatePicker-input":{background:"none",border:0,borderBottom:"1px solid",borderRadius:0}}})})]})]}),e(Ne,{errors:p,formInputsData:g,handleChange:N,selectedTeam:P,setFormInputsData:x,setSelectedTeam:I,setSelectedSportName:i}),t.toLocaleLowerCase()==="taekwondo"?m(E,{children:[m("div",{className:"flex gap-4 my-2",children:[e("div",{className:"w-1/2",children:e(k,{id:"world_weight",label:"World Weight",error:p.weight,name:"world_weight",onChange:o=>N("world_weight",o.target.value),sx:{".mantine-TextInput-input":{background:"none",border:0,borderBottom:"1px solid",borderRadius:0}}})}),e("div",{className:"w-1/2",children:e(k,{id:"olympic_weight",label:"Olympic Weight",error:p.weight,name:"olympic_weight",onChange:o=>N("olympic_weight",o.target.value),sx:{".mantine-TextInput-input":{background:"none",border:0,borderBottom:"1px solid",borderRadius:0}}})})]}),e("div",{className:"my-2",children:e(D,{id:"front_leg",error:p.front_leg,className:"w-full",label:"Preferred Front Leg",name:"front_leg",sx:{".mantine-Select-input":{background:"none",border:0,borderBottom:"1px solid",borderRadius:0,width:"100%"}},data:[{value:"LEFT",label:"Left"},{value:"RIGHT",label:"Right"},{value:"BOTH",label:"Both"}]})}),e("div",{className:"my-2",children:e(k,{id:"height",label:"Height",name:"height",error:p.height,onChange:o=>N("height",o.target.value),sx:{".mantine-TextInput-input":{background:"none",border:0,borderBottom:"1px solid",borderRadius:0}}})})]}):m("div",{className:"flex gap-4 my-4",children:[e("div",{className:"w-1/2",children:e(k,{id:"weight",label:"Weight",error:p.weight,name:"weight",onChange:o=>N("weight",o.target.value),sx:{".mantine-TextInput-input":{background:"none",border:0,borderBottom:"1px solid",borderRadius:0}}})}),e("div",{className:"w-1/2",children:e(k,{id:"height",label:"Height",name:"height",error:p.height,onChange:o=>N("height",o.target.value),sx:{".mantine-TextInput-input":{background:"none",border:0,borderBottom:"1px solid",borderRadius:0}}})})]}),e("div",{className:"w-full my-4",children:e(k,{id:"phoneNumber",label:"phone number",name:"phone",error:p.phoneNumber,onChange:o=>N("phoneNumber",o.target.value),sx:{".mantine-TextInput-input":{background:"none",border:0,borderBottom:"1px solid",borderRadius:0}}})}),e(Z,{isLoading:v,text:"Add Player"})]})}),e($,{position:"left",children:e("button",{className:"py-1 px-4 transform hover:scale-105 transition-all text-xs border border-perfGray3 text-perfGray3 rounded-3xl",onClick:()=>w(!0),children:"+ Create Player"})})]})})},Ae=J().shape({mobile:C().required("Phone number is required").length(11,"phone number must be 11 characters long").matches(/^\d+$/,"phone number must only contain numbers"),first_name:C().required("First name is required"),last_name:C().required("Last name is required"),sport:G().required("You Must select a sport").typeError("You Have to select a sport"),teams:de().of(G()).min(1,"At least on team is required"),password:C().required("Password is required").min(8,"Password must be at least 8 characters long"),confirmPassword:C().required("Please confirm your password").oneOf([ce("password"),null],"Passwords must match")}),U={first_name:"",last_name:"",sport:"",teams:[],password:"",confirmPassword:"",mobile:""},Pe=f=>{const[t,{open:i,close:n}]=ue(!1),{data:s}=M(null),[d,w]=l.exports.useState(U),[g,x]=l.exports.useState(!1),[S,r]=l.exports.useState(null),[c,h]=l.exports.useState({}),{refetch:v}=te({club_id:s==null?void 0:s.club},{skip:!(s!=null&&s.club)}),u=(a,B)=>{w({...d,[a]:B})},[p,b]=l.exports.useState([]),[P,I]=W.useState([]),[A,N]=l.exports.useState(0),{data:R}=Y({club_id:s==null?void 0:s.club},{skip:!(s!=null&&s.club)}),{data:o}=z({sport_id:A},{skip:!A});l.exports.useEffect(()=>{R&&R.results&&b(R.results),o&&o.results.length>0?I(o.results):(I([]),w({...d,teams:[]}),r(null))},[R,o,A]);const[y]=me();return m(E,{children:[e(X,{opened:t,onClose:n,title:"Add Attendance Moderator",children:m("form",{onSubmit:async a=>{a.preventDefault();const B=new FormData(a.currentTarget);for(const[T,q]of B.entries())console.log(`${T}: ${q}`);const re={mobile:"+2"+d.mobile,first_name:d.first_name,last_name:d.last_name,password:d.password,teams:d.teams};try{x(!0),await Ae.validate(d,{abortEarly:!1}),y(re).then(()=>{x(!1),n(),v(),w(U),F.showNotificationFun("Success","Done","Attendance Modeartor Added Successfully")}).catch(T=>{x(!1),console.log(),F.showNotificationFun("Error","Sorry",T.response.statusText)})}catch(T){x(!1);const q={};T instanceof ee&&(T.inner.forEach(j=>{q[j.path]=j.message}),h(q))}},className:"rounded-xl py-4 flex flex-col gap-4 justify-between",children:[e(k,{id:"mobile",name:"mobile",label:"Mobile",withAsterisk:!0,error:c.mobile,onChange:a=>u("mobile",a.target.value),sx:{".mantine-TextInput-input":{background:"none",border:0,borderBottom:"1px solid",borderRadius:0,width:"100%"}}}),m("div",{className:"flex gap-2",children:[e(k,{id:"first_name",name:"first_name",label:"First Name",withAsterisk:!0,error:c.first_name,onChange:a=>u("first_name",a.target.value),sx:{".mantine-TextInput-input":{background:"none",border:0,borderBottom:"1px solid",borderRadius:0,width:"100%"}}}),e(k,{autoComplete:"off",id:"last_name",name:"last_name",label:"Last Name",withAsterisk:!0,error:c.last_name,onChange:a=>u("last_name",a.target.value),sx:{".mantine-TextInput-input":{background:"none",border:0,borderBottom:"1px solid",borderRadius:0,width:"100%"}}})]}),m("div",{className:"flex flex-col gap-4 w-full my-4",children:[e(D,{error:c.sport,id:"sport",required:!0,className:"w-full",label:"Sport",name:"sport",sx:{".mantine-Select-input":{background:"none",border:0,borderBottom:"1px solid",borderRadius:0,width:"100%"}},data:p==null?void 0:p.map(a=>({value:a.id,label:a.name})),onChange:a=>{a&&N(+a),a&&u("sport",+a)}}),e(pe,{id:"teams",error:c.teams,required:!0,className:"w-full",label:"Teams",name:"teams",value:S,onChange:a=>{console.log(a),a&&(r(a),u("teams",a))},sx:{".mantine-MultiSelect-input":{background:"none",border:0,borderBottom:"1px solid",borderRadius:0,width:"100%"}},data:P==null?void 0:P.map(a=>({label:a.name,value:a.id}))})]}),e(Q,{autoComplete:"new-password",id:"password",name:"password",label:"Password",error:c.password,withAsterisk:!0,onChange:a=>u("password",a.target.value),sx:{".mantine-PasswordInput-input":{border:0},".mantine-PasswordInput-innerInput":{background:"none",border:0,borderBottom:"1px solid",borderRadius:0,width:"100%"}}}),e(Q,{autoComplete:"new-password",id:"confirmPassword",name:"confirm Password",label:"Confirm Password",error:c.confirmPassword,withAsterisk:!0,onChange:a=>u("confirmPassword",a.target.value),sx:{".mantine-PasswordInput-input":{border:0},".mantine-PasswordInput-innerInput":{background:"none",border:0,borderBottom:"1px solid",borderRadius:0,width:"100%"}}}),e(Z,{isLoading:g,text:"Create Att Moderator"})]})}),e($,{position:"left",children:m(E,{children:[e("button",{className:"py-1 xs:hidden px-4 transform hover:scale-105 transition-all text-xs sm:text-base border border-perfGray3 text-perfGray3 rounded-3xl",onClick:i,children:"+"}),e("button",{className:"py-1 px-4 hidden xs:block transform hover:scale-105 transition-all text-xs border border-perfGray3 text-perfGray3 rounded-3xl",onClick:i,children:"+ Add Attendance Moderator"})]})})]})},L=({type:f,data:t})=>{const[i,n]=l.exports.useState(""),[s,d]=l.exports.useState(t),[w,g]=l.exports.useState(),[x,S]=l.exports.useState(["All"]),{data:r}=M({}),{data:c}=Y({club_id:r==null?void 0:r.club});return l.exports.useEffect(()=>{if(c){let h=["All"];for(let v of c.results)h.push(v.name);S(h)}},[c]),l.exports.useEffect(()=>{if(i.length>0){let h;f==="Player"?h=H.filter(t,v=>{var u;return(u=v.name)==null?void 0:u.toLowerCase().includes(i.toLocaleLowerCase())}):h=H.filter(t,v=>{let u=v.first_name+v.last_name;return u==null?void 0:u.toLowerCase().includes(i.toLocaleLowerCase())}),d(h)}else d(t)},[i,t]),m("div",{className:"bg-white rounded-lg p-4 pt-0 ",children:[m("div",{className:"header flex flex-col sm:flex-row justify-between items-start py-4",children:[m("h2",{className:"text-sm sm:text-lg text-perfGray1 mb-2 sm:mb-0",children:[f==="Coach"?"Coaches":f+"s"," in the system"]}),m("div",{className:"flex gap-6 justify-center items-center",children:[f==="Player"&&e(ke,{}),f==="Attendance Moderator"&&e(Pe,{}),e(D,{placeholder:"Filter By Sport",value:w,onChange:h=>g(h),data:x}),e(k,{onChange:h=>n(h.target.value),value:i,icon:e(he,{className:"w-5 h-5",icon:"MagnifyingGlassIcon:outline"}),placeholder:"Search"})]})]}),e("div",{className:"h-60 overflow-y-scroll",children:e(ae,{className:"w-full",gutter:"sm",children:s&&s.length>0?e(Ie,{newData:s,selectedSport:w,type:f}):e("div",{className:"flex w-full items-center justify-center pt-10",children:m("h1",{className:"bg-pagesBg p-6",children:["No ",f," In this Club"]})})})})]})},Ie=({newData:f,selectedSport:t,type:i})=>{const n=be(),[s]=fe(),[d]=ge(),[w]=xe(),[g]=we(),x=r=>{let c;switch(i.toLowerCase()){case"player":c=s({player_id:r});break;case"coach":c=d({coach_id:r});break;case"supervisor":c=w({supervisor_id:r});break;case"attendance moderator":c=g({subCoach_id:r});break;default:throw new Error("Invalid user type")}c.then(v=>{F.showNotificationFun("Success","Done","Successfully Deleted")}).catch(v=>{F.showNotificationFun("Error","Wrong","err.message")})},S=f.filter(r=>!t||t==="All"?!0:r.sport===t);return S.length===0?e("div",{className:"flex w-full items-center justify-center pt-10",children:m("h1",{className:"bg-pagesBg p-6",children:[t," Sport doesn't have any ",i]})}):S.map(r=>e(ae.Col,{className:"w-fit h-fit",span:12,xs:6,sm:4,children:m("div",{className:"flex justify-between rounded-3xl mr-10 items-center p-1  hover:bg-pagesBg transition-all",children:[m("div",{onClick:()=>i==="Player"&&n(`/players/${r.id}`),style:{cursor:i==="Player"?"pointer":"auto"},className:"coach-data flex gap-2 items-center",children:[e(V,{src:r.avatar||r.icon,size:"sm",radius:"xl"}),e("h3",{className:"text-base text-perfGray2",children:r.first_name&&r.first_name+" "+r.last_name||r.name})]}),e(ve,{deleteFun:()=>x(JSON.stringify(r.id)),type:i,name:r.first_name||r.name})]})},r.id))},Te=f=>{const{data:t}=M({}),{data:i}=K({club_id:t==null?void 0:t.club},{skip:!(t!=null&&t.club)}),{data:n}=ye({club_id:t==null?void 0:t.club},{skip:!(t!=null&&t.club)}),{data:s}=Se({club_id:t==null?void 0:t.club},{skip:!(t!=null&&t.club)}),{data:d}=te({club_id:t==null?void 0:t.club},{skip:!(t!=null&&t.club)});return m("div",{className:"flex flex-col gap-6  pt-6 mb-10",children:[e(L,{type:"Coach",data:n==null?void 0:n.results}),d&&e(L,{type:"Attendance Moderator",data:d==null?void 0:d.results}),e(L,{type:"Supervisor",data:s==null?void 0:s.results}),e(L,{type:"Player",data:i==null?void 0:i.results})]})};export{Te as default};
